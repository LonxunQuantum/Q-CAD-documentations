<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Transition dipole moment calculation include local field &mdash; Q-CAD 0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="NEB (nudged elastic band) calculation" href="NEB_Calculation.html" />
    <link rel="prev" title="Transition dipole moment calculation exclude local field" href="Trans_dipole_moment_exclude_Calculation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Q-CAD
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../PWmat.html">PWmat</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../PWmat.html#download">Download</a></li>
<li class="toctree-l2"><a class="reference internal" href="../PWmat.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../PWmat.html#manual">Manual</a></li>
<li class="toctree-l2"><a class="reference internal" href="../PWmat.html#input-files">Input Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../PWmat.html#output-files">Output Files</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../PWmat.html#examples">Examples</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Si_SCF_Calculation.html">SCF calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="Si_DOS_Calculation.html">DOS calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="Si_Band_Calculation.html">Bandsctructure calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="GaAs_HSE_SCF_Calculation.html">HSE SCF calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="GaAs_HSE_Band_Calculation.html">HSE bandsctructure calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="Si_RELAX_Calculation.html">Crystal Structure Optimization (only relax atomic position)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Graphene_CELL_REL_Calculation.html">Crystal Structure Optimization (both atomic position and cell shape)</a></li>
<li class="toctree-l3"><a class="reference internal" href="GaAs_HSE_REL_Calculation.html">HSE Relaxation calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="BN_C_Charge_Relaxation_Cal.html">Charge system relaxation calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="Cu-Au-Alloy-MD-Calculation.html">Ab Initio Molecular Dynamics</a></li>
<li class="toctree-l3"><a class="reference internal" href="Ni_SCF_Spin_Calculation.html">Spin-polarized calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="CdSe_SOC_Band_Calculation.html">Spin-orbit coupling bandstructure calculation without magnetic moment</a></li>
<li class="toctree-l3"><a class="reference internal" href="Fe_Spin222_SCF_Calculation.html">Spin-orbit coupling with noncollinear magnetization calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="Ni_SCF_DFTU_Calculation.html">DFT+U Calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="Trans_dipole_moment_exclude_Calculation.html">Transition dipole moment calculation exclude local field</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Transition dipole moment calculation include local field</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#first-step-scf-calculation">First Step: “SCF” calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#second-step-nonscf-calculation">Second Step: “NONSCF” calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#third-step-moment-calculation">Third Step: “MOMENT” calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fourth-step-run-tdm-x">Fourth Step: run TDM.x</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="NEB_Calculation.html">NEB (nudged elastic band) calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="Dimer_Calculation.html">Dimer method to calculate saddle point</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../PWmat.html#tutorials">Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../PWmat.html#modules">Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../PWmat.html#utilities">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../PWmat.html#cases">Cases</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../MLFF/MLFF.html">PWMat Machine Learning Force Field</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PWkit/PWkit.html">PWkit</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Q-CAD</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../PWmat.html">PWmat</a></li>
      <li class="breadcrumb-item active">Transition dipole moment calculation include local field</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/Examples/Trans_dipole_moment_include_Calculation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="transition-dipole-moment-calculation-include-local-field">
<h1>Transition dipole moment calculation include local field<a class="headerlink" href="#transition-dipole-moment-calculation-include-local-field" title="Permalink to this heading"></a></h1>
<p>Transition dipole moment calculaton in CsPbI3.</p>
<p>There are four steps, the first step is “SCF” calculation, the second is “NONSCF” calculation, the third is “MOMENT” calculation, and the fourth step is to process the data with TDM.x tool.</p>
<section id="first-step-scf-calculation">
<h2>First Step: “SCF” calculation<a class="headerlink" href="#first-step-scf-calculation" title="Permalink to this heading"></a></h2>
<section id="input-files">
<h3>Input files<a class="headerlink" href="#input-files" title="Permalink to this heading"></a></h3>
<p>atom.config</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="mi">5</span>
<span class="n">LATTICE</span>
     <span class="mf">6.39011884</span>     <span class="mf">0.00000000</span>     <span class="mf">0.00000000</span>
     <span class="mf">0.00000000</span>     <span class="mf">6.39011884</span>     <span class="mf">0.00000000</span>
     <span class="mf">0.00000000</span>     <span class="mf">0.00000000</span>     <span class="mf">6.39011884</span>
<span class="n">POSITION</span>
 <span class="mi">55</span>     <span class="mf">0.50000000</span>     <span class="mf">0.50000000</span>     <span class="mf">0.50000000</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
 <span class="mi">82</span>     <span class="mf">0.00000000</span>     <span class="mf">0.00000000</span>     <span class="mf">0.00000000</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
 <span class="mi">53</span>     <span class="mf">0.00000000</span>     <span class="mf">0.00000000</span>     <span class="mf">0.50000000</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
 <span class="mi">53</span>     <span class="mf">0.50000000</span>     <span class="mf">0.00000000</span>     <span class="mf">0.00000000</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
 <span class="mi">53</span>     <span class="mf">0.00000000</span>     <span class="mf">0.50000000</span>     <span class="mf">0.00000000</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
</pre></div>
</div>
<p>etot.input</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">4</span>  <span class="mi">1</span>
<span class="n">JOB</span> <span class="o">=</span> <span class="n">SCF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP1</span> <span class="o">=</span> <span class="n">Cs</span><span class="o">.</span><span class="n">SG15</span><span class="o">.</span><span class="n">PBE</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP2</span> <span class="o">=</span> <span class="n">Pb</span><span class="o">-</span><span class="n">d</span><span class="o">.</span><span class="n">SG15</span><span class="o">.</span><span class="n">PBE</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP3</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">SG15</span><span class="o">.</span><span class="n">PBE</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="n">CONVERGENCE</span> <span class="o">=</span> <span class="n">difficult</span>
<span class="n">Ecut</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">Ecut2</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">MP_N123</span> <span class="o">=</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
</pre></div>
</div>
<p>Cs.SG15.PBE.UPF, Pb-d.SG15.PBE.UPF, I.SG15.PBE.UPF</p>
</section>
<section id="calculations">
<h3>Calculations<a class="headerlink" href="#calculations" title="Permalink to this heading"></a></h3>
<p>1.You can submit PWmat tasks in different ways:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mpirun</span> <span class="o">-</span><span class="n">np</span> <span class="mi">4</span> <span class="n">PWmat</span> <span class="o">|</span> <span class="n">tee</span> <span class="n">output</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Run the command directly</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
#PBS -N SCF
#PBS -l nodes=1:ppn=4
#PBS -q batch
#PBS -l walltime=100:00:00

ulimit -s unlimited
cd $PBS_O_WORKDIR

mpirun -np 4 PWmat | tee output
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Submit the task with a pbs script</p>
</div>
</section>
<section id="download">
<h3>Download<a class="headerlink" href="#download" title="Permalink to this heading"></a></h3>
<p><a class="reference external" href="examples/Step1_scf_cal.tar.gz">Step1_scf_cal</a></p>
</section>
</section>
<section id="second-step-nonscf-calculation">
<h2>Second Step: “NONSCF” calculation<a class="headerlink" href="#second-step-nonscf-calculation" title="Permalink to this heading"></a></h2>
<section id="id1">
<h3>Input files<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h3>
<p>atom.config</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="mi">5</span>
<span class="n">LATTICE</span>
     <span class="mf">6.39011884</span>     <span class="mf">0.00000000</span>     <span class="mf">0.00000000</span>
     <span class="mf">0.00000000</span>     <span class="mf">6.39011884</span>     <span class="mf">0.00000000</span>
     <span class="mf">0.00000000</span>     <span class="mf">0.00000000</span>     <span class="mf">6.39011884</span>
<span class="n">POSITION</span>
 <span class="mi">55</span>     <span class="mf">0.50000000</span>     <span class="mf">0.50000000</span>     <span class="mf">0.50000000</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
 <span class="mi">82</span>     <span class="mf">0.00000000</span>     <span class="mf">0.00000000</span>     <span class="mf">0.00000000</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
 <span class="mi">53</span>     <span class="mf">0.00000000</span>     <span class="mf">0.00000000</span>     <span class="mf">0.50000000</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
 <span class="mi">53</span>     <span class="mf">0.50000000</span>     <span class="mf">0.00000000</span>     <span class="mf">0.00000000</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
 <span class="mi">53</span>     <span class="mf">0.00000000</span>     <span class="mf">0.50000000</span>     <span class="mf">0.00000000</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
</pre></div>
</div>
<p>etot.input</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">4</span>  <span class="mi">1</span>
<span class="n">JOB</span> <span class="o">=</span> <span class="n">NONSCF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP1</span> <span class="o">=</span> <span class="n">Cs</span><span class="o">.</span><span class="n">SG15</span><span class="o">.</span><span class="n">PBE</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP2</span> <span class="o">=</span> <span class="n">Pb</span><span class="o">-</span><span class="n">d</span><span class="o">.</span><span class="n">SG15</span><span class="o">.</span><span class="n">PBE</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP3</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">SG15</span><span class="o">.</span><span class="n">PBE</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="n">Ecut</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">Ecut2</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">IN</span><span class="o">.</span><span class="n">VR</span> <span class="o">=</span> <span class="n">T</span>
<span class="n">IN</span><span class="o">.</span><span class="n">KPT</span> <span class="o">=</span> <span class="n">T</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>1.How to get IN.VR and IN.KPT, please refer to the example <a class="reference external" href="Si_Band_Calculation.html">Bandstructure calculation</a>.
2.The file gen.kpt:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BAND</span>                      <span class="c1"># COMMENT line</span>
<span class="mi">20</span>                      <span class="c1"># number of k-points between X and R</span>
<span class="mf">0.000</span>  <span class="mf">0.500</span>  <span class="mf">0.000</span>  <span class="n">X</span>  <span class="c1"># reciprocal coordinates; label &#39;X&#39; for X point</span>
<span class="mf">0.500</span>  <span class="mf">0.500</span>  <span class="mf">0.500</span>  <span class="n">R</span>
<span class="mi">20</span>
<span class="mf">0.500</span>  <span class="mf">0.500</span>  <span class="mf">0.500</span>  <span class="n">R</span>
<span class="mf">0.500</span>  <span class="mf">0.500</span>  <span class="mf">0.000</span>  <span class="n">M</span>
<span class="mi">20</span>
<span class="mf">0.500</span>  <span class="mf">0.500</span>  <span class="mf">0.000</span>  <span class="n">M</span>
<span class="mf">0.000</span>  <span class="mf">0.000</span>  <span class="mf">0.000</span>  <span class="n">G</span>
<span class="mi">20</span>
<span class="mf">0.000</span>  <span class="mf">0.000</span>  <span class="mf">0.000</span>  <span class="n">G</span>
<span class="mf">0.500</span>  <span class="mf">0.500</span>  <span class="mf">0.500</span>  <span class="n">R</span>
</pre></div>
</div>
</div>
<p>Cs.SG15.PBE.SOC.UPF, Pb-d.SG15.PBE.SOC.UPF, I.SG15.PBE.UPF</p>
</section>
<section id="id2">
<h3>Calculations<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h3>
<p>1.You can submit PWmat tasks in different ways:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mpirun</span> <span class="o">-</span><span class="n">np</span> <span class="mi">4</span> <span class="n">PWmat</span> <span class="o">|</span> <span class="n">tee</span> <span class="n">output</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Run the command directly</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
#PBS -N SCF
#PBS -l nodes=1:ppn=4
#PBS -q batch
#PBS -l walltime=100:00:00

ulimit -s unlimited
cd $PBS_O_WORKDIR

mpirun -np 4 PWmat | tee output
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Submit the task with a pbs script</p>
</div>
</section>
<section id="id3">
<h3>Download<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h3>
<p><a class="reference external" href="examples/Step2_initial_scf_cal.tar.gz">Step2_initial_scf_cal</a></p>
</section>
</section>
<section id="third-step-moment-calculation">
<h2>Third Step: “MOMENT” calculation<a class="headerlink" href="#third-step-moment-calculation" title="Permalink to this heading"></a></h2>
<section id="id4">
<h3>Input files<a class="headerlink" href="#id4" title="Permalink to this heading"></a></h3>
<p>atom.config</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="mi">5</span>
<span class="n">LATTICE</span>
     <span class="mf">6.39011884</span>     <span class="mf">0.00000000</span>     <span class="mf">0.00000000</span>
     <span class="mf">0.00000000</span>     <span class="mf">6.39011884</span>     <span class="mf">0.00000000</span>
     <span class="mf">0.00000000</span>     <span class="mf">0.00000000</span>     <span class="mf">6.39011884</span>
<span class="n">POSITION</span>
 <span class="mi">55</span>     <span class="mf">0.50000000</span>     <span class="mf">0.50000000</span>     <span class="mf">0.50000000</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
 <span class="mi">82</span>     <span class="mf">0.00000000</span>     <span class="mf">0.00000000</span>     <span class="mf">0.00000000</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
 <span class="mi">53</span>     <span class="mf">0.00000000</span>     <span class="mf">0.00000000</span>     <span class="mf">0.50000000</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
 <span class="mi">53</span>     <span class="mf">0.50000000</span>     <span class="mf">0.00000000</span>     <span class="mf">0.00000000</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
 <span class="mi">53</span>     <span class="mf">0.00000000</span>     <span class="mf">0.50000000</span>     <span class="mf">0.00000000</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
</pre></div>
</div>
<p>etot.input</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">4</span>  <span class="mi">1</span>
<span class="n">JOB</span> <span class="o">=</span> <span class="n">MOMENT</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP1</span> <span class="o">=</span> <span class="n">Cs</span><span class="o">.</span><span class="n">SG15</span><span class="o">.</span><span class="n">PBE</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP2</span> <span class="o">=</span> <span class="n">Pb</span><span class="o">-</span><span class="n">d</span><span class="o">.</span><span class="n">SG15</span><span class="o">.</span><span class="n">PBE</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP3</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">SG15</span><span class="o">.</span><span class="n">PBE</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="n">Ecut</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">Ecut2</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">IN</span><span class="o">.</span><span class="n">WG</span> <span class="o">=</span> <span class="n">T</span>
<span class="n">IN</span><span class="o">.</span><span class="n">KPT</span> <span class="o">=</span> <span class="n">T</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<div class="line-block">
<div class="line">1.Read IN.WG from previous NONSCF calculation OUT.WG.</div>
<div class="line">2.IN.KPT is the same as previous NONSCF calculation.</div>
</div>
</div>
<p>Cs.SG15.PBE.SOC.UPF, Pb-d.SG15.PBE.SOC.UPF, I.SG15.PBE.UPF</p>
</section>
<section id="id5">
<h3>Calculations<a class="headerlink" href="#id5" title="Permalink to this heading"></a></h3>
<p>1.You can submit PWmat tasks in different ways:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mpirun</span> <span class="o">-</span><span class="n">np</span> <span class="mi">4</span> <span class="n">PWmat</span> <span class="o">|</span> <span class="n">tee</span> <span class="n">output</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Run the command directly</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
#PBS -N SCF
#PBS -l nodes=1:ppn=4
#PBS -q batch
#PBS -l walltime=100:00:00

ulimit -s unlimited
cd $PBS_O_WORKDIR

mpirun -np 4 PWmat | tee output
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Submit the task with a pbs script</p>
</div>
</section>
<section id="id6">
<h3>Download<a class="headerlink" href="#id6" title="Permalink to this heading"></a></h3>
<p><a class="reference external" href="examples/Step2_final_scf_cal.tar.gz">Step2_final_scf_cal</a></p>
</section>
</section>
<section id="fourth-step-run-tdm-x">
<h2>Fourth Step: run TDM.x<a class="headerlink" href="#fourth-step-run-tdm-x" title="Permalink to this heading"></a></h2>
<section id="id7">
<h3>Input files<a class="headerlink" href="#id7" title="Permalink to this heading"></a></h3>
<p>TDM.input</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>           <span class="c1">#flag: possible values 0, 1. 0: no nonlocal potential; 1: nonlocal potential is taken into account</span>
<span class="mi">37</span> <span class="mi">38</span>       <span class="c1">#i,j: TDM between j and j state.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>flag 0: TDM.x will read TDM.input, OUT.WG and OUT.GKK.</p></li>
<li><p>flag 1: TDM.x will read TDM.input OUT.EIGEN (from NONSCF calculation) and OUT.momentK.* (* represents multiple files)</p></li>
</ol>
</div>
<p>2.After run TDM.x, you will get transition_moment file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ikpt</span>  <span class="n">X</span><span class="o">-</span><span class="n">component</span>  <span class="n">Y</span><span class="o">-</span><span class="n">component</span>  <span class="n">Z</span><span class="o">-</span><span class="n">component</span>   <span class="n">Total</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">bohr</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>       <span class="n">X</span><span class="o">-</span><span class="n">real</span>       <span class="n">X</span><span class="o">-</span><span class="n">imag</span>       <span class="n">Y</span><span class="o">-</span><span class="n">real</span>       <span class="n">Y</span><span class="o">-</span><span class="n">imag</span>       <span class="n">Z</span><span class="o">-</span><span class="n">real</span>       <span class="n">Z</span><span class="o">-</span><span class="n">imag</span>
 <span class="mi">1</span>   <span class="mf">0.1124E-10</span>   <span class="mf">0.4523E+02</span>   <span class="mf">0.5442E-11</span>          <span class="mf">0.4523E+02</span>   <span class="mf">0.2364E-05</span>   <span class="mf">0.2377E-05</span>   <span class="mf">0.6271E+01</span>  <span class="o">-</span><span class="mf">0.2429E+01</span>   <span class="mf">0.2119E-05</span>   <span class="mf">0.9759E-06</span>
 <span class="mi">2</span>   <span class="mf">0.3188E-11</span>   <span class="mf">0.4526E+02</span>   <span class="mf">0.6448E-11</span>          <span class="mf">0.4526E+02</span>   <span class="mf">0.1636E-05</span>   <span class="mf">0.7138E-06</span>  <span class="o">-</span><span class="mf">0.6213E+01</span>  <span class="o">-</span><span class="mf">0.2581E+01</span>   <span class="mf">0.2401E-05</span>  <span class="o">-</span><span class="mf">0.8256E-06</span>
 <span class="mi">3</span>   <span class="mf">0.1467E-10</span>   <span class="mf">0.4540E+02</span>   <span class="mf">0.5686E-11</span>          <span class="mf">0.4540E+02</span>  <span class="o">-</span><span class="mf">0.2051E-05</span>  <span class="o">-</span><span class="mf">0.3234E-05</span>  <span class="o">-</span><span class="mf">0.1739E+01</span>   <span class="mf">0.6510E+01</span>  <span class="o">-</span><span class="mf">0.2089E-05</span>  <span class="o">-</span><span class="mf">0.1150E-05</span>
 <span class="o">...</span>
 <span class="o">...</span>
 <span class="o">...</span>
 <span class="mi">83</span>   <span class="mf">0.2256E+02</span>   <span class="mf">0.1981E+01</span>   <span class="mf">0.1117E+02</span>          <span class="mf">0.3571E+02</span>  <span class="o">-</span><span class="mf">0.4708E+01</span>  <span class="o">-</span><span class="mf">0.6294E+00</span>   <span class="mf">0.1398E+01</span>   <span class="mf">0.1604E+00</span>   <span class="mf">0.3310E+01</span>   <span class="mf">0.4689E+00</span>
 <span class="mi">84</span>   <span class="mf">0.3497E+02</span>   <span class="mf">0.8254E+01</span>   <span class="mf">0.1196E+02</span>          <span class="mf">0.5519E+02</span>   <span class="mf">0.3534E+01</span>  <span class="o">-</span><span class="mf">0.4742E+01</span>  <span class="o">-</span><span class="mf">0.6782E+00</span>   <span class="mf">0.2792E+01</span>  <span class="o">-</span><span class="mf">0.2856E+01</span>   <span class="mf">0.1950E+01</span>
 <span class="mi">85</span>   <span class="mf">0.5507E+02</span>   <span class="mf">0.6404E+01</span>   <span class="mf">0.4207E+01</span>          <span class="mf">0.6568E+02</span>  <span class="o">-</span><span class="mf">0.2326E+01</span>   <span class="mf">0.7047E+01</span>   <span class="mf">0.1363E+01</span>  <span class="o">-</span><span class="mf">0.2132E+01</span>   <span class="mf">0.1990E+01</span>  <span class="o">-</span><span class="mf">0.4951E+00</span>
</pre></div>
</div>
</section>
<section id="id8">
<h3>Download<a class="headerlink" href="#id8" title="Permalink to this heading"></a></h3>
<p><a class="reference external" href="examples/momoment_with_nonlocal_cal.tar.gz">momoment_with_nonlocal_cal</a></p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Trans_dipole_moment_exclude_Calculation.html" class="btn btn-neutral float-left" title="Transition dipole moment calculation exclude local field" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="NEB_Calculation.html" class="btn btn-neutral float-right" title="NEB (nudged elastic band) calculation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, LongXun.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>